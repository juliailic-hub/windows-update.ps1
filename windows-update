# windows-update.ps1
Set-ExecutionPolicy Bypass -Scope Process -Force

if (-not (Get-Module -ListAvailable -Name PSWindowsUpdate)) {
    Install-Module -Name PSWindowsUpdate -Force -Scope AllUsers
}

Import-Module PSWindowsUpdate -Force

Write-Host "Checking for updates..."
$updates = Get-WindowsUpdate
$updates | Format-Table -AutoSize

$choice = Read-Host "Do you want to install all updates now? (Y/N)"
if ($choice -match '^[Yy]$') {
    Install-WindowsUpdate -AcceptAll -IgnoreReboot -Verbose
    Write-Host "Updates installed. Please reboot if required."
} else {
    Write-Host "Skipped installation."
}
